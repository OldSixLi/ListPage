<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>已开票订单管理</title>
	<!-- Bootstrap -->
	<link rel="stylesheet" href="../Style/bootstrap.css">
	<link rel="stylesheet" href="../Style/select2.min.css">

	<style>
		td>a {
			margin: 10px;
		}

		#databody>tr>td {
			color: #7a7676;
			line-height: 25px;
			text-align: center;
		}

		tr>th {
			text-align: center;
		}

		#databody>.tr-cancel>td {
			color: #ddd;
		}

		#databody>.tr-cancel>td.state {
			color: red;
		}

		.tr-cancel>td>a {
			color: #ddd;
			disabled: false;
		}

		.a-delete {
			color: red;
		}
	</style>
</head>
<!--设置页面主体的颜色 -->

<body style="background-color:#f5f5f5;padding:50px;" ng-app="myApp">
	<div ng-controller="customersCtrl">
		<!-- 面包屑导航 -->
		<ol class="breadcrumb col-xs-3" style="border-radius:0;padding:0 15px;">
			<li><a href="javascript:void(0)">发票管理</a></li>
			<li class="active">已开票订单管理</li>
		</ol>

		<!-- 搜索模块 -->
		<div class="text-right col-xs-9" id="search_block" style="background-color:#f5f5f5;">
			<form class="form-inline" action="" method="post" role="form">
				<label for="">发票代码：</label>
				<div class="form-group text-left">
					<input type="text" class="form-control" value="" placeholder="请输入发票代码" style="width: 270px;font-size:0.9em">

					<select class="" name="" id="sltInvoiceType" style="width:200px;text-align:left;">
				<option value="">全部</option>
				<option value="">全部2</option>
				<option value="">全部4</option>
			</select></div>

				<a href="javascript:;" ng-click="search()" class="btn btn-primary">确定</a>
			</form>
		</div>
		<div class="ng-scope tab-content container-fluid" style="background-color:white;padding:20px;">
			<!-- 数据部分 -->
			<table class="table table-hover">
				<thead>
					<tr>
						<th>#</th>
						<th>发票代码</th>
						<th>客户名称</th>
						<th>销售网点</th>
						<th>开票类型</th>
						<th>状态 </th>
						<th>订单日期</th>
						<th class="text-center">操作</th>
					</tr>
				</thead>

				<tbody id="databody">
					<tr ng-repeat="x in names.list">
						<td>{{ $index+names.page.currentPage*10-9}}</td>
						<td>{{ x.FP_HM }}</td>
						<td>{{ x.NSRMC }}</td>
						<td>{{ x.ID }}</td>
						<td>{{ x.FP_DM }}</td>
						<td>{{ x.AMOUNT?x.AMOUNT:"0.00" }}</td>
						<td>{{ x.KPRQ?x.KPRQ:"2017年2月16日14:04:10" }}</td>
						<td>
							<a href="#?id={{x.FP_HM}}">操作</a></td>
					</tr>
				</tbody>

			</table>
		</div>
		<!-- 翻页控件 -->
		<div class="pull-right">
			<ul class="pagination" id="alreadyPage"></ul>
		</div>
	</div>
	<!-- 脚本 -->
	<script type="text/javascript" src="../Script/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="../Script/angular.min.js"></script>
	<script type="text/javascript" src="../Script/bootstrap.js"></script>
	<script type="text/javascript" src="../Script/select2.js"></script>
	<script type="text/javascript" src="../Script/bootstrap-paginator.js"></script>
	<!--IE8支持HTML5元素和媒体查询 -->
	<!-- WARNING: Respond.js doesn' t work if you view the page via file:// -->
	<!--[if lt IE 9]>
      <script src="../Script/html5shiv.js"></script>
      <script src="../Script/respond.min.js"></script>
    <![endif]-->
	<script>
		var params = "&";
		var app = angular.module('myApp', []);
		app.controller('customersCtrl', function($scope, $http) {
			var pageing = function(pageindex, params) {
				var url = "../JSON/data.json?" + "pageindex" + pageindex + " & params=" + params; //请求的参数和地址
				$http.get(url).success(function(data) {
					if (data != null && data != "" && data != "null") {
						if (data.list != null && data.list.length > 0) {
							$scope.names = data;
							paginators($("#alreadyPage"), data.page.currentPage, data.page.totalPage);
							$("#alreadyPage").show();
						} else {
							$("#databody").html('<tr><td colspan="100" class="text-center notFound">没有相关数据</td></tr> ');
							$("#alreadyPage").hide(); //未获取到数据时删除操作
						}
					}
				});
				$.getJSON(url, function(data) {
					if (data != null && data != "" && data != "null") {
						if (data.list != null && data.list.length > 0) {
							$scope.names = data;
							paginators($("#alreadyPage"), data.page.currentPage, data.page.totalPage);
							$("#alreadyPage").show();
						} else {
							$("#databody").html('<tr><td colspan="100" class="text-center notFound">没有相关数据</td></tr> ');
							$("#alreadyPage").hide(); //未获取到数据时删除操作
						}
					}
				});
			}
			pageing(1, params);
			//查询按钮
			$scope.search = function() {
				pageing(1, params);
			}
		});

		var changeSelect = function($dom, hasSearch) {
			var selectNum = 0;
			if (typeof(hasSearch) != 'undefined') {
				if (hasSearch == false) {
					selectNum = -1;
				}
			}
			$dom.select2({
				tags: true,
				maximumSelectionLength: 3,
				minimumResultsForSearch: selectNum
				// 最多能够选择的个数
			});
		};

		$(function() {

			$(".breadcrumb,#search_block").height("45px");

			//修改下拉菜单样式
			changeSelect($("#sltInvoiceType"), false);
		});



		//翻页控件的设置
		function paginators($dom, currentPage, totalPage) {
			var options = {
				bootstrapMajorVersion: 3,
				currentPage: currentPage,
				totalPages: totalPage,
				numberOfPages: 3, //显示的页数
				itemTexts: function(type, page, current) {
					switch (type) {
						case "first":
							return "首页";
						case "prev":
							return "<";
						case "next":
							return ">";
						case "last":
							return "尾页";
						case "page":
							return page;
					}
				}
			}
			$dom.bootstrapPaginator(options);
		}
		var objstr =
			'{"list":[{"INVOICE_STATE":"","ORDER_ID":"20170105173142341000000000000006","FP_HM":"24255556","NSRMC":"神州","ID":"31473","FP_DM":"1200162320","FPLXDM":"007","AMOUNT":"35000.00","FLAG_INVOICE":"3","KPRQ":"2017-01-17 10:01:34"},{"INVOICE_STATE":"10","ORDER_ID":"900000001","FP_HM":"00022688","NSRMC":"天津市亿方达建筑砌块有限公司","ID":"20992","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":"360.00","FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900000264","FP_HM":"0000333","NSRMC":"天津卓和信仪器仪表有限公司","ID":"21248","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900000521","FP_HM":"00002871","NSRMC":"天津凯兰环保科技有限公司","ID":"21504","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900000782","FP_HM":"00010320","NSRMC":"天津福祥自行车有限公司","ID":"21760","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900001038","FP_HM":"00016358","NSRMC":"天津华衡伟业生产力促进有限公司","ID":"22016","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900001296","FP_HM":"00018775","NSRMC":"天津市屹泰锘采油设备有限公司","ID":"22272","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900001552","FP_HM":"00026778","NSRMC":"贝思赫尔印刷设备（天津）有限公司","ID":"22528","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900001808","FP_HM":"00029783","NSRMC":"天津市天兵畜牧养殖专业合作社","ID":"22784","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null},{"INVOICE_STATE":null,"ORDER_ID":"900002064","FP_HM":"00035501","NSRMC":"天津捷丰晟金属制品有限公司","ID":"23040","FP_DM":"0000000000","FPLXDM":"007","AMOUNT":null,"FLAG_INVOICE":"3","KPRQ":null}],"page":{"showCount":10,"totalPage":1035,"totalResult":10343,"currentPage":1,"pd":{"fphm":null,"invoicestate":"2","fpdm":null,"pointid":null,"invoicetype":null}}}';
	</script>
</body>

</html>
